if(!window.LChart){throw new Error('未能加载loongchart.core.js，该js必须在其他LChart框架的js加载之前被引用。\n'+'Not loaded loongchart.core.js which must be loaded before other LChart\'s js.');}else{LChart.Const.Skins.BlackAndWhite.RangeHistogram3D={SmallLabelColor:null,BigLabelColor:null}}LChart.RangeHistogram3D=LChart.getCore().__extends({GraphType:'RangeHistogram3D'});LChart.RangeHistogram3D._spreadSkin=function(a,b){a.smallLabel={};a.smallLabel.color=b.SmallLabelColor||null;a.bigLabel={};a.bigLabel.color=b.BigLabelColor||null};LChart.RangeHistogram3D._getDefaultOptions=function(c){var d=LChart.Methods.Extend(c,{animateY:true,animateX:true,histogram:{colors:null,length:null,gap:null,useSameColor:true},tip:{content:function(a){var b=null;if(this.valueType=='d'){b='<br/>Small Value: '+a.value[0].format('yyyy-MM-dd')+'<br/>Big Value: '+a.value[1].format('yyyy-MM-dd')}else if(this.valueType=='t'){b='<br/>Small Value: '+a.value[0].format('MM-dd hh:mm')+'<br/>Big Value: '+a.value[1].format('MM-dd hh:mm')}else if(this.valueType=='m'){b='<br/>Small Value: '+a.value[0].format('hh:mm:ss.S')+'<br/>Big Value: '+a.value[1].format('hh:mm:ss.S')}else{b='<br/>Small Value: '+a.value[0]+'<br/>Big Value: '+a.value[1]}return'<div>'+a.text+'：'+b+'&nbsp;</div>'}},smallLabel:{show:true,content:function(a){if(this.valueType=='d'){return a.format('yyyy-MM-dd')}else if(this.valueType=='t'){return a.format('MM-dd hh:mm')}else if(this.valueType=='m'){return a.format('hh:mm:ss.S')}else{return a.toString()}},color:null,fontweight:null,fontsize:null,fontfamily:null},bigLabel:{show:true,content:function(a){if(this.valueType=='d'){return a.format('yyyy-MM-dd')}else if(this.valueType=='t'){return a.format('MM-dd hh:mm')}else if(this.valueType=='m'){return a.format('hh:mm:ss.S')}else{return a.toString()}},color:null,fontweight:null,fontsize:null,fontfamily:null}});return d};LChart.RangeHistogram3D._getCheckOptions=function(){return{__top:[['animateY','b'],['animateX','b']],histogram:[['colors','ca'],['length','n'],['gap','n'],['useSameColor','b']],smallLabel:[['show','b'],['content','f'],['color','c'],['fontweight','s'],['fontsize','n'],['fontfamily','s']],bigLabel:[['show','b'],['content','f'],['color','c'],['fontweight','s'],['fontsize','n'],['fontfamily','s']]}};LChart.RangeHistogram3D._drawgraphic=function(w,z,A,B){if(B.valueType=='p'){throw new Error(w._messages.WrongParam+w._messages.ValueTypeMustNotBePercent);}w._configs.recreateAssists=true;if(z==w.ID){w._configs.valueAxiaDataIsRange=true}var C=w._formatAxisData();var D=w._calculateOutersValid();var E=w._computeAxis(D);var F=w._getDrawableCoordinate();w.shapes[z]={histograms:[]};if(!w.coordinates.histograms){w.coordinates.histograms={}}w.coordinates.histograms[z]=[];var G=w._configs.specificConfig[z];var H=B.shadow.show&&B.shadow.blur>0;var I=H?{color:B.shadow.color,blur:B.shadow.blur}:null;var J=C.vValueType=='p';var K=B.histogram.length;var L=B.histogram.gap;if(C.multiple){if(L&&L>0){var M=(E.labelDistance-C.demanCount*2)/(C.demanCount+1);L=Math.min(L,M)}else{L=E.labelDistance/20}}var K=B.histogram.length;if(K&&K>0){var N=C.multiple?((E.labelDistance-(C.demanCount+1)*L)/C.demanCount):E.labelDistance*0.8;K=Math.min(K,N)}else{K=(E.labelDistance-(C.demanCount+1)*L)/(C.multiple?(C.demanCount+0.5):1.5)}var O=(B.histogram.colors&&B.histogram.colors.length>0?B.histogram.colors:null)||LChart.Const.Defaults.FillColors;if(z==w.ID){w.coordinates.draw=F;w._configs.legendColors=O}var P=function(a,b,c,d,e,f){var g=a.left-E.stagewidth*E.sinsightangle;var h=a.top+E.stagewidth*E.cossightangle;var i=b||a.color;if(e){w.DrawFigures.create3DHistogram(g,h,a.width,a.height,i,0,E.sightangle,E.stagewidth,null,c?b:a.topcolor||LChart.Methods.getDarkenColor(i,0.7),c?b:a.rightcolor||LChart.Methods.getDarkenColor(i,0.8),d)}if(f){var j=a.data.value[0];var k=a.data.value[1];if(j>k){j=a.data.value[1];k=a.data.value[0]}var l=B.smallLabel;if(l.show){var m=typeof l.content=='function'?l.content.call(B,j):'';if(m){var n=a.data.smallfontsize||l.fontsize||LChart.Methods.CapValue(height,18,11);var o=a.data.smallfontweight||l.fontweight;var p=a.data.smallfontcolor||l.color;var q=(a.left+g)/2+a.width/2;var r=h+a.height+n;w.DrawFigures.createText(m,q,r,'center',o,n,l.fontfamily,p)}}l=B.bigLabel;if(l.show){var s=typeof l.content=='function'?l.content.call(B,k):'';if(s){var n=a.data.bigfontsize||l.fontsize||LChart.Methods.CapValue(height,18,11);var o=a.data.bigfontweight||l.fontweight;var p=a.data.bigfontcolor||l.color;var q=(a.left+g)/2+a.width/2;var r=a.top-n/3;w.DrawFigures.createText(s,q,r,'center',o,n,l.fontfamily,p)}}}};var Q=function(f,g,h,i,j,k,l,m,n,o){this.indexX=f;this.indexY=g;this.left=h;this.top=i;this.width=j;this.height=k;this.data=o;this.isHovered=false;this.color=l;this.topcolor=m;this.rightcolor=n;this.redraw=function(a,b,c,d){var e=I;if(H&&d){e=LChart.Methods.DeepCopy(I);e.color=d}P(this,d,a,e,b,c)};this.click=function(e){var a=typeof this.data.click=='function'?this.data.click:(B.click||null);if(a){a(this.data,e)}};if(B.tip.show&&typeof B.tip.content=='function'){this.tip=null;this.showTip=function(){if(this.tip){this.tip.style.display='inline'}else{var a=this.left;var b=this.top+this.height/2;this.tip=w._createTip(B.tip.content.call(B,this.data),a,b);if(a+this.tip.clientWidth>E.maxX){w._changeTip(this.tip,a-this.tip.clientWidth)}var c=this;c.tip.onclick=function(e){c.click(e)}}};this.hideTip=function(){if(this.tip){this.tip.style.display='none'}}}};var R=function(e,f){var g=function(a){var b=(B.animateY?e:1)*(E.maxY-E.minY)*w._getFormatDiff(C.vValueType,C.vMinValue,a)/w._getFormatDiff(C.vValueType,C.vMinValue,C.vMaxValue);return b};var h=function(a,b,c){var d=(c&&B.animateY?e:1)*(E.maxY-E.minY)*w._getFormatDiff(C.vValueType,a,b)/w._getFormatDiff(C.vValueType,C.vMinValue,C.vMaxValue);return d};var j=f>=1;var l=[];for(var i=0,item;item=A[i];i++){var m=(B.animateX?e:1)*K;if(C.multiple){var n=item.color||O[i%O.length];var o=J?item.percent:item.value;for(var k=0;k<o.length;k++){var p=o[k];var q=C.demanCount/2-i;var r=E.startPos+E.labelDistance*k-q*K-(q-0.5)*L;var s=g(p);var t=E.maxY-s;var s=h(p[0],p[1],true);var t=E.maxY-s-h(C.vMinValue,Math.min(p[0],p[1]));var u=null;if(j){u={click:item.click,mouseover:item.mouseover,mouseleave:item.mouseleave,text:item.text,indexX:i,indexY:k,bigfontcolor:item.bigfontcolor,bigfontsize:item.bigfontsize,bigfontweight:item.bigfontweight,smallfontcolor:item.smallfontcolor,smallfontsize:item.smallfontsize,smallfontweight:item.smallfontweight};if(J){u.percent=p;u.value=item.value[k]}else{u.value=p}if(!w.coordinates.histograms[z][k]){w.coordinates.histograms[z][k]=[]}w.coordinates.histograms[z][k][i]={left:r,top:t,width:m,height:s,color:n}}var v=new Q(i,k,r,t,m,s,n,item.topcolor,item.rightcolor,u);l.push(v)}}else{var p=J?item.percent:item.value;var r=E.startPos+E.labelDistance*i-K/2;var s=h(p[0],p[1],true);var t=E.maxY-s-h(C.vMinValue,Math.min(p[0],p[1]));var n=item.color||(B.histogram.useSameColor?'rgba(69,114,167,1)':O[i%O.length]);if(j){w.coordinates.histograms[z][i]={left:r,top:t,width:m,height:s,color:n}}var v=new Q(i,1,r,t,m,s,n,item.topcolor,item.rightcolor,item);l.push(v)}}if(C.multiple){l.sort(function(a,b){if(a.indexX==b.indexX){return a.indexY-b.indexY}else{return a.indexX-b.indexX}})}for(var i=0,v;v=l[i];i++){P(v,v.color,false,I,true)}if(j){for(var i=0,v;v=l[i];i++){P(v,v.color,false,I,false,true)}w.shapes[z].histograms=l}};var S=function(){var h=function(x,y){var a=null;var b=E.cossightangle*E.stagewidth;var c=E.sinsightangle*E.stagewidth;for(var i=0,shape;shape=w.shapes[z].histograms[i];i++){var d=shape.left-E.stagewidth*E.sinsightangle;var e=shape.top+E.stagewidth*E.cossightangle;if(d<=x&&d+shape.width>=x&&e<=y&&e+shape.height>=y){a=shape;break}}if(!a){for(var i=0,shape;shape=w.shapes[z].histograms[i];i++){if(shape.top<=y&&shape.top+b>=y){var f=shape.left-c*(y-shape.top)/b;if(f<=x&&f+shape.width>=x){a=shape;break}}}}if(!a){for(var i=0,shape;shape=w.shapes[z].histograms[i];i++){if(shape.left+shape.width-c<=x&&shape.left+shape.width>=x){var g=shape.top+b*(shape.left+shape.width-x)/c;if(g<=y&&g+shape.height>=y){a=shape;break}}}}return a};var j=function(e){var e=window.event||e;var a=w._getMouseLoction(e);var b=h(a.X,a.Y);if(b){b.click(e)}};var k=function(e){var e=window.event||e;var a=w._getMouseLoction(e);var b=h(a.X,a.Y);if(b){w._configs.cursorPointer=true}if(G.currentMouseShape!=b){var c=G.currentMouseShape;if(c){var d=typeof c.data.mouseleave=='function'?c.data.mouseleave:(B.mouseleave||null);if(d){d(c.data,e)}}if(H||G.currentMouseShape){w.redrawAll()}G.currentMouseShape=b;for(var i=0,c;c=w.shapes[z].histograms[i];i++){if(c!=b&&c.isHovered){c.isHovered=false;if(c.hideTip){c.hideTip()}}}if(b){b.isHovered=true;var f=B.mouseoverTransparency;b.redraw(true,true,false,'rgba(255,255,255,'+(f>0&&f<1?f:0.2)+')');if(b.showTip){b.showTip()}var g=typeof b.data.mouseover=='function'?b.data.mouseover:(B.mouseover||null);if(g){g(b.data,e)}}}};w._addEventListener('click',j);w._addEventListener('mousemove',k)};var T=function(){for(var i=0,shape;shape=w.shapes[z].histograms[i];i++){shape.redraw(false,true)}for(var i=0,shape;shape=w.shapes[z].histograms[i];i++){shape.redraw(false,false,true)}};return{drawSegments:R,mouseEvents:S,redraw:T}};